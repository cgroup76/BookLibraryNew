<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Games</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="games.css">

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.1.min.js"
            integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ="
            crossorigin="anonymous"></script>
    <!-- Bootstrap -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>

    <!-- SweetAlert -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script src="images.js"></script>
    <script src="sharedFunc.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@microsoft/signalr@7.0.0/dist/browser/signalr.min.js"></script>



    <script>
        const gameAPI = "https://localhost:7225/api/Score";
        const booksAPI = "https://localhost:7225/api/Books";
        const authorsAPI = "https://localhost:7225/api/Authors";
        let gameName;
        let allBooks = [];
        let wordList = [];
        let allAuthors = [];

        $(document).ready(function () {
            getBooks();
            loadAuthors();
            $('button').click(openGame)
            $('.closeGameButton').click(closeGame);
            $(".btn-next-back").hide();
            $(".btn-back").hide();
            $(".btn-back").click(backQuestion);
            $(".btn-next").click(nextQuestion);
            $(".clear-ans-btn").click(clearAnswersCheckBox);
            $(".start-quiz").click(startQuiz)
        });

        function loadAuthors() {
            if (allAuthors.length == 0) {
                ajaxCall("GET", authorsAPI, null, SuccessLoadAuthors, errorLoadAuthors);
            }
        }


        function SuccessLoadAuthors(authors) {
            allAuthors = authors;
        }



        function errorLoadAuthors(error) {
            console.log('Error loading authors:', error);
        }
        function getBooks() {
            if (allBooks.length == 0) {
                ajaxCall("GET", booksAPI, null, getAllBooks, errorToLoadBooks);
            }
        }

        function getAllBooks(books) {
            allBooks = books;
            for (let i = 0; i < books.length; i++) {
                wordList.push(books[i].Title);
            }
        }

        function errorToLoadBooks() {
            console.error("The books could not be loaded.");
        }

        function closeGame() {
            $('#games').removeClass('active');
            $('#overlay').removeClass('active');
            clearHangMan();
            closeQuiz();
        }
        function openGame() {
            gameName = $(this).attr('id');
            $('#games').addClass('active');
            $('#overlay').addClass('active');

            console.log(gameName);
            switch (gameName) {
                case 'HangMan':
                    {
                        $('#container-quiz').hide()
                        $('#container-Memorybody').hide()
                        $('#container-hangMan').show()
                        startHangManGame();
                    }
                    break;
                case 'MemoryGame':
                    {
                        $('#container-quiz').hide()
                        $('#container-Memorybody').show()
                        $('#container-hangMan').hide()
                        startMemoryGame();

                    }
                    break;
                case 'BookQuiz': {
                    $('#container-quiz').show()
                    $('#container-Memorybody').hide()
                    $('#container-hangMan').hide()
                    createQuiz();
                }
                    break;
            }

        }


    </script>
</head>

<body>
    <header class="bg-dark text-white py-2 fixed-top">
        <div class="container">
            <nav class="navbar navbar-expand-lg navbar-dark sticky-top">

                <a class="navbar-brand" id="nav-title">Book Store</a>

                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbar">
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item"><a class="nav-link text-white" href="HTMLPage1.html">Home</a></li>
                        <li class="nav-item adminPage"><a class="nav-link text-white " href="adminPage.html">Admin Page</a></li>
                        <li class="nav-item myBooks"><a class="nav-link text-white " href="myBooks.html">My Books</a></li>
                        <li class="nav-item"><a class="nav-link text-white" href="author.html">Authors</a></li>
                        <li class="nav-item"><a class="nav-link text-white" href="TheGoodBookClub.html">Books Clubs</a></li>
                        <li class="nav-item games"><a class="nav-link text-white games" href="games.html">games</a></li>
                        <li class="nav-item loginBox"><a class="nav-link text-white login">login</a></li>
                        <li class="nav-item userNameBox">
                            <a class="nav-link text-white userName"></a>
                        </li>
                        <li class="nav-item logoutBox"><a class="nav-link pink whiteHover logout" style="color: #ff0083">logout</a></li>
                        <li class="nav-item dropdown requestBox">
                            <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <span id="message-count" class="badge">0</span> <!-- Badge -->
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-envelope" viewBox="0 0 16 16">
                                    <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1zm13 2.383-4.708 2.825L15 11.105zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741M1 11.105l4.708-2.897L1 5.383z" />
                                </svg>
                            </button>
                            <div class="dropdown-menu dropdown-menu-dark dropdown-menu-right" aria-labelledby="dropdownMenuButton">
                                <div class="send"> </div>
                                <div class="got"> </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>
    </header>
    <div class=" container mt-5 pt-5">
        <div class="row">
            <div class="col-lg-4">
                <div class="cardMain mb-4 game-card">
                    <h6>HangMan</h6>
                    <div class="card-body text-center">
                        <button id="HangMan">Play</button>
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="cardMain mb-4 game-card">
                    <h6>Memory Game</h6>
                    <div class="card-body text-center">
                        <button id="MemoryGame">Play</button>
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="cardMain mb-4 game-card">
                    <h6>Quiz</h6>
                    <div class="card-body text-center">
                        <button id="BookQuiz">Play</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="games">
        <div id="container-quiz">
            <div class="quiz-header">
                <button data-close-button class="close-button closeGameButton">&times;</button>
                <br />
                <h1 class="text-center text-dark">Books Quiz</h1>
            </div>
            <h5 class="timer"></h5>
            <div class="quis-instruction">
                <h4 class="text-center pink">Instructions:</h4>
                <p>1. You have 1 minute to answer all the questions.</p>
                <p>2. Read each question carefully before selecting your answer.</p>
                <p>3. Click 'Submit' when you're done to see your score.</p>
            </div>
            <div id="questionContainer"></div>
            <div class="resultContainer pink"></div>
            <button class="btn btn-outline-dark btn-block pinkB start-quiz">Start Quiz</button>
            <div class='btn-next-back'>
                <button class='btn btn-outline-dark pinkB btn-back'>Back</button>
                <button class='btn btn-outline-dark pinkB btn-next'>Next</button>
            </div>
        </div>
        <div id="container-Memorybody" class="Memorybody ">
            <button data-close-button class="close-button closeGameButton">&times;</button>
            <div class="game-container ">
                <div class="stats ">
                    <p class="pink">Attempts: <span id="attempts">0</span></p>
                    <p class="pink">Time: <span id="time">0</span> seconds</p>
                </div>
                <div id="game-board" class="game-board row"></div>
            </div>
            <div class="resultContainer pink"></div>
        </div>

        <div id="container-hangMan" >
            <button data-close-button class="close-button closeGameButton">&times;</button>

            <div class="hangman-box text-center">
                <h1>Hangman Game</h1>
            </div>

            <div class="game-box container-fluid">
                <div class="row word-display text-center"></div>

                <h3 class="failedGuess text-center">
                    Incorrect guesses:
                    <b></b>
                    <br />
                </h3>

                <h3 class="correctWord text-center" style="display: none;">
                    The Correct Word Was: <span></span>
                </h3>

                <div id="image-container" class="row d-flex justify-content-center"></div>
                <div id="row-1" class="row keyboard-row d-flex flex-wrap justify-content-center"></div>

                <!--<div id="button-container">-->
                <!--</div>-->
            </div>

            <div class="resultContainer pink text-center"></div>
        </div>


    </div>

    <div id="overlay"></div>
    <script src="games.js"></script>
</body>

</html>
